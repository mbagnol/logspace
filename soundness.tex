The aim of this subsection is to prove the following theorem:

\theorem[space soundness]
	{\label{soundness}Let $\,\phi\in\C O_\Sigma^+\,$ be an observation over $\,\Sigma\,$.
	\begin{itemize}
		\item $\lang(\phi)\,$ is decidable in non-deterministic logarithmic space.
		\item If $\,\phi\,$ is isometric, then $\lang(\phi)\,$ is decidable in deterministic logarithmic space.
	\end{itemize}
}

The main tool for this purpose is the notion of \emph{computation space}: a finite dimensional subspace of $\,\closedh\,$ on which we will be able to observe the behaviour of our wirings.% This notion is reminiscent of the notion of separating vector 

\define[separating space]
{A subspace $\,E\,$ of $\,\closedh\,$ is \emph{separating} for a wiring $\,F\,$ whenever it is stable by $\,F\,$ and $\,F^n(E)=0\,$ implies $\,F^n=0\,$.}

As observations are \emph{finite} sums of wirings, we are able to naturally associate a finite-dimensional vector space to an observation and a finite set of closed terms.

\define[computation space]
{Let $\,\{\,t_0,\dots, t_n\,\}\,$ be a set of distinct closed terms and $\,\phi\in\C O_\Sigma^\concrete\,$ an observation.

Let $\,N(\phi)\,$ be the smallest integer and $\,\TT S(\phi)\,$ the smallest (finite) set of closed terms such that $\,\phi \in \Sigma\tensor\IO\tensor\C S_{N(\phi)}\otimes\TT S(\phi) \,$.

\smallskip
The \emph{computation space} $\,\comp_\phi (t_0\dots t_n)\,$ is the subspace of $\,\closedh\,$ generated by the terms
\[s\p \TT c\p \TT d \p (\,a_1\p\,\cdots\,\p a_{N(\phi)}\,\p\, \start)\]
where $\,s\in \TT S(\phi)\,$, $\,\TT c\in \Sigma\,$, $\,d\in\IO\,$ and the $\,a_i\in \{\,t_0,\dots, t_n\,\}\,$.
}

\lemma[dimension]
{The dimension of $\,\comp_\phi (t_0\dots t_n)\,$ is $\,2|\TT S(\phi)|\,|\Sigma|(n+1)^{N(\phi)}\,$.}

\lemma[separation]
{\label{sep}For any observation $\,\phi\,$ and any word $\,W\,$, the space $\,\comp_\phi(t_0\dots t_n)$ is separating for the wiring $\,\phi \,W(t_0\dots t_n)\,$.}

\proof[of theorem \ref{soundness}]{With these lemmas at hand, we can define the following non-deterministic algorithm

\begin{algorithmic}[1]
\STATE compute $\,N(\phi)\,$ and $\,S(\phi)\,$
\STATE $D\gets 2|\TT S(\phi)|\,|\Sigma|(n+1)^{N(\phi)}$
\STATE $C\gets 0$
\STATE pick a term $\,t\in\comp_\phi(t_i)\,$
\WHILE{$C\leq D$}
	\IF{$(\phi W(t_i))(v)=0$}
		\RETURN ACCEPT
	\ENDIF
	\STATE pick a vector $\,v'\,$ in $\,(\phi W(t_i))(v)\,$
	\STATE $v\gets v'$
	\STATE $C\gets C+1$
\ENDWHILE
\RETURN REJECT
\end{algorithmic}

\smallskip
All computation paths accept if and only if $\,(\phi W(t_i))^n(\comp_\phi(t_i))=0\,$ for some $\,n\,$ lesser or equal to the dimension of the computation space.
By Lemma \ref{sep}, this is equivalent to $\,\phi W(t_i)\,$ nilpotent.

The algorithm can run in logarithmic space, because it only needs to store a vector of a vector space of dimension $\,D=2|\TT S(\phi)|\,|\Sigma|(n+1)^{N(\phi)}\,$ (which can be represented as an integer lesser or equal to $\,D\,$), and the two integers $\,C,D\,$.
The computation of $\,(\phi W(t_i))(v)\,$ at line 6 and 9 and  can be performed in logarithmic space by theorem \ref{unif-logspace}, as all terms used words representations and observations are linear.

\smallskip
Moreover, if $\,\phi\,$ is an isometric wiring, $\,(\phi W(t_i))(v)\,$ consists of a single vector instead of a sum by Lemma \ref{lem:isom}, and there is therefore no non-deterministic choice to be made at line 9.
It is enough to run the algorithm enumerating all possible vectors of $\,\comp_\phi(t_i)\,$ at line 4 to determine the nilpotency of $\,\phi W(t_i)\,$.
}
