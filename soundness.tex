The aim of this subsection is to prove the following theorem:

\theorem[space soundness]
	{\label{soundness}Let $\,\phi\in\C O_\Sigma^+\,$ be an observation over $\,\Sigma\,$.
	\begin{itemize}
		\item $\lang(\phi)\,$ is decidable in non-deterministic logarithmic space.
		\item If $\,\phi\,$ is isometric, then $\lang(\phi)\,$ is decidable in deterministic logarithmic space.
	\end{itemize}
}

The main tool for this purpose is the notion of \emph{computation space}: a finite dimensional subspace of $\,\closedh\,$ on which we will be able to observe the behaviour of our wirings, the place where all the relevant computation takes place.% This notion is reminiscent of the notion of separating vector 

\define[separating space]
{A subspace $\,E\,$ of $\,\closedh\,$ is \emph{separating} for a wiring $\,F\,$ whenever it is stable by $\,F\,$ and $\,F^n(E)=0\,$ implies $\,F^n=0\,$.}

As observations are \emph{finite} sums of wirings, we are able, given an observation together with a finite set of closed terms, to naturally associate to them a finite-dimensional vector space.

\define[computation space]
{\label{compspace}Let $\,\{\,t_0,\dots, t_n\,\}\,$ be a set of distinct closed terms and $\,\phi\in\C O_\Sigma^\concrete\,$ an observation.

Let $\,N(\phi)\,$ be the smallest integer and $\,\TT S(\phi)\,$ the smallest (finite) set of closed terms such that $\,\phi \in \Sigma\tensor\IO\tensor\C S_{N(\phi)}\otimes\TT S(\phi) \,$.

\smallskip
The \emph{computation space} $\,\comp_\phi (t_0\dots t_n)\,$ is the subspace of $\,\closedh\,$ generated by the terms
\[s\p \TT c\p \TT d \p (\,a_1\p\,\cdots\,\p a_{N(\phi)}\,\p\, \start)\]
where $\,s\in \TT S(\phi)\,$, $\,\TT c\in \Sigma\,$, $\,d\in\IO\,$ and the $\,a_i\in \{\,t_0,\dots, t_n\,\}\,$.

The dimension of $\,\comp_\phi (t_0\dots t_n)\,$ is $\,\card{\Sigma} \times 2 \times (n+1)^{N(\phi)}\times \card{\TT S(\phi)}\,$, that is to say ---~given a word $w$ of length $n$~--- $\bigO(N(\phi) \times \log(n))$. 
}



\lemma[separation]
{\label{sep}For any observation $\,\phi\,$ and any word $\,W\,$, the space $\,\comp_\phi(t_0\dots t_n)$ is separating for the wiring $\,\phi \,W(t_0\dots t_n)\,$.}

\proof[of theorem \ref{soundness}]{With these lemmas at hand, we can define the following non-deterministic algorithm below

\begin{multicols}{2}
%\begin{wrapfigure}[18]{l}{0.5\textwidth}
\begin{algorithmic}[1]
\STATE compute $\,N(\phi)\,$ and $\,S(\phi)\,$
\STATE $D\gets 2|\TT S(\phi)|\,|\Sigma|(n+1)^{N(\phi)}$
\STATE $C\gets 0$
\STATE pick a term $\,t\in\comp_\phi(t_i)\,$
\WHILE{$C\leq D$}
	\IF{$(\phi W(t_i))(v)=0$}
		\RETURN ACCEPT
	\ENDIF
	\STATE pick a vector $\,v'\,$ in $\,(\phi W(t_i))(v)\,$
	\STATE $v\gets v'$
	\STATE $C\gets C+1$
\ENDWHILE
\RETURN REJECT
\end{algorithmic}
\end{multicols}
%\caption{Nilpotency algorithm}
%\end{wrapfigure}

\smallskip
All computation paths accept if and only if $\,(\phi W(t_i))^n(\comp_\phi(t_i))=0\,$ for some $\,n\,$ lesser or equal to the dimension $D$ of the computation space $\,\comp_\phi(t_i)\,$.
By Lemma \ref{sep}, this is equivalent to $\,\phi W(t_i)\,$ nilpotent.

The vector chosen at lines 4 is erased by the one chosen at line 9 every time we go through the {\bf while}-loop, and is of size at most $D$.
The values $C$ and $D$ that need to be stored are the size of the computation space, of size logarithmic in the size of the input as we mentionned in Definition \ref{compspace}.
\medskip
%The algorithm can run in logarithmic space, because it only needs to store a vector of a vector space of dimension $\,D=2|\TT S(\phi)|\,|\Sigma|(n+1)^{N(\phi)}\,$ (which can be represented as an integer lesser or equal to $\,D\,$), and the two integers $\,C,D\,$.
The computation of $\,(\phi W(t_i))(v)\,$ at line 6 and 9 and  can be performed in logarithmic space by Theorem \ref{unif-logspace}, as all terms used in words representations and observations are linear and shares no variables.


\smallskip
Moreover, if $\,\phi\,$ is an isometric wiring, $\,(\phi W(t_i))(v)\,$ consists of a single vector instead of a sum by Lemma \ref{lem_isom}, and there is therefore no non-deterministic choice to be made at line 9.
It is enough to run the algorithm enumerating all possible vectors of $\,\comp_\phi(t_i)\,$ at line 4 to determine the nilpotency of $\,\phi W(t_i)\,$.
}
